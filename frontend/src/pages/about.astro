---
import BaseLayout from '@/layouts/BaseLayout.astro'
import RichText from '@/components/RichText.astro'
import Container from '@/components/layout/Container.astro'
import { sanity } from '@/lib/sanity'
import { urlForImage } from '@/lib/sanityImage'
import { aboutPageQuery } from '@/lib/sanityQueries'

const page = sanity ? await sanity.fetch<any>(aboutPageQuery) : null
const portraitUrl =
  page?.portrait?.image &&
  urlForImage(page.portrait.image)?.width(1000).height(1250).fit('crop').auto('format').url()
---

<BaseLayout title={page?.seo?.metaTitle || page?.title || 'About'}>
  <Container size="wide" class="space-y-8">
    <header class="space-y-3">
      <h1 class="text-4xl tracking-tight">{page?.title || 'About'}</h1>
    </header>
    <section class="grid gap-8 md:grid-cols-2 md:items-start">
      <div class="max-w-3xl">
        <RichText value={page?.content} />
      </div>
      {
        portraitUrl ? (
          <div class="md:justify-self-end">
            <img
              src={portraitUrl}
              alt={page?.portrait?.alt || page?.title || ''}
              loading="lazy"
              class="aspect-4/5 w-full max-w-md object-cover"
            />
          </div>
        ) : null
      }
    </section>
  </Container>
</BaseLayout>
